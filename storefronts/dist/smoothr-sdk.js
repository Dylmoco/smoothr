(function(e,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("@supabase/supabase-js")):typeof define=="function"&&define.amd?define(["exports","@supabase/supabase-js"],r):(e=typeof globalThis<"u"?globalThis:e||self,r(e.SmoothrSDK={},e.Supabase))})(this,function(e,r){"use strict";const c=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),d=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),s=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),f=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),_=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),b=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),g=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),m=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),p=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),y=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));let i;function S({supabaseUrl:t,supabaseKey:o}){i=r.createClient(t,o),w(),j()}function w(){document.querySelectorAll('[data-smoothr-auth="login"]').forEach(t=>{t.addEventListener("submit",async o=>{o.preventDefault();const n=new FormData(t),a=n.get("email"),O=n.get("password"),{data:v,error:T}=await i.auth.signInWithPassword({email:a,password:O});if(!T){document.dispatchEvent(new CustomEvent("smoothr:login",{detail:v}));const P=await l("login");window.location.href=P}})})}function j(){document.querySelectorAll('[data-smoothr-auth="logout"]').forEach(t=>{t.addEventListener("click",async o=>{o.preventDefault(),await i.auth.signOut(),document.dispatchEvent(new CustomEvent("smoothr:logout"));const n=await l("logout");window.location.href=n})})}function u(t){return t.replace(/^www\./,"").toLowerCase()}async function l(t){const o=u(window.location.hostname);try{const{data:n,error:a}=await i.from("stores").select(`${t}_redirect_url`).eq("store_domain",o).single();if(a||!n)throw a;return n[`${t}_redirect_url`]||window.location.origin}catch{return window.location.origin}}const h=Object.freeze(Object.defineProperty({__proto__:null,initAuth:S,lookupRedirectUrl:l,normalizeDomain:u},Symbol.toStringTag,{value:"Module"}));e.abandonedCart=c,e.affiliates=d,e.analytics=s,e.auth=h,e.currency=f,e.dashboard=_,e.discounts=b,e.orders=g,e.returns=m,e.reviews=p,e.subscriptions=y,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
