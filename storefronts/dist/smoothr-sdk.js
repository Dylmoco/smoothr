(function(e,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("@supabase/supabase-js")):typeof define=="function"&&define.amd?define(["exports","@supabase/supabase-js"],i):(e=typeof globalThis<"u"?globalThis:e||self,i(e.SmoothrSDK={},e.Supabase))})(this,function(e,i){"use strict";const s=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),f=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),_=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),b=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),g=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),m=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),y=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),p=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),S=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),w=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));let a;function h({supabaseUrl:t,supabaseKey:n}){a=i.createClient(t,n),j(),O()}function j(){document.querySelectorAll('[data-smoothr-auth="login"]').forEach(t=>{t.addEventListener("submit",async n=>{n.preventDefault();const o=new FormData(t),r=o.get("email"),T=o.get("password");try{const{data:c,error:d}=await a.auth.signInWithPassword({email:r,password:T});if(d)console.error(d);else{document.dispatchEvent(new CustomEvent("smoothr:login",{detail:c}));const P=await l("login");window.location.href=P}}catch(c){console.error(c)}})})}function O(){document.querySelectorAll('[data-smoothr-auth="logout"]').forEach(t=>{t.addEventListener("click",async n=>{n.preventDefault();const{error:o}=await a.auth.signOut();o&&console.error(o),document.dispatchEvent(new CustomEvent("smoothr:logout"));const r=await l("logout");window.location.href=r})})}function u(t){return t.replace(/^www\./,"").toLowerCase()}async function l(t){const n=u(window.location.hostname);try{const{data:o,error:r}=await a.from("stores").select(`${t}_redirect_url`).eq("store_domain",n).single();if(r||!o)throw r;return o[`${t}_redirect_url`]||window.location.origin}catch(o){return console.error(o),window.location.origin}}const v=Object.freeze(Object.defineProperty({__proto__:null,initAuth:h,lookupRedirectUrl:l,normalizeDomain:u},Symbol.toStringTag,{value:"Module"}));e.abandonedCart=s,e.affiliates=f,e.analytics=_,e.auth=v,e.currency=b,e.dashboard=g,e.discounts=m,e.orders=y,e.returns=p,e.reviews=S,e.subscriptions=w,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
